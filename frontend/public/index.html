# frontend/public/index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="RAG System Web Interface"
    />
    <title>RAG System</title>
    <style>
      body {
        margin: 0;
        font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen',
          'Ubuntu', 'Cantarell', 'Fira Sans', 'Droid Sans', 'Helvetica Neue',
          sans-serif;
        -webkit-font-smoothing: antialiased;
        -moz-osx-font-smoothing: grayscale;
        background-color: #f5f5f5;
      }
    </style>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>

# frontend/src/App.js
import React, { useState, useEffect } from 'react';
import axios from 'axios';
import './App.css';

const API_BASE_URL = process.env.REACT_APP_RAG_API_URL || 'http://localhost:8002';
const LLM_API_URL = process.env.REACT_APP_LLM_API_URL || 'http://localhost:8003';

function App() {
  const [files, setFiles] = useState([]);
  const [uploadStatus, setUploadStatus] = useState('');
  const [searchQuery, setSearchQuery] = useState('');
  const [searchResults, setSearchResults] = useState([]);
  const [chatMessage, setChatMessage] = useState('');
  const [chatHistory, setChatHistory] = useState([]);
  const [stats, setStats] = useState(null);
  const [loading, setLoading] = useState(false);
  const [activeTab, setActiveTab] = useState('upload');

  useEffect(() => {
    fetchStats();
  }, []);

  const fetchStats = async () => {
    try {
      const response = await axios.get(`${API_BASE_URL}/documents/stats`);
      setStats(response.data);
    } catch (error) {
      console.error('Error fetching stats:', error);
    }
  };

  const handleFileUpload = async (event) => {
    const selectedFiles = Array.from(event.target.files);
    setFiles(selectedFiles);
    
    if (selectedFiles.length === 0) return;

    const formData = new FormData();
    selectedFiles.forEach(file => {
      formData.append('files', file);
    });

    try {
      setLoading(true);
      setUploadStatus('–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...');
      
      const response = await axios.post(`${API_BASE_URL}/documents/upload`, formData, {
        headers: {
          'Content-Type': 'multipart/form-data',
        },
      });
      
      setUploadStatus(`–£—Å–ø—ñ—à–Ω–æ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ: ${response.data.message}`);
      fetchStats();
      
    } catch (error) {
      setUploadStatus(`–ü–æ–º–∏–ª–∫–∞: ${error.response?.data?.detail || error.message}`);
    } finally {
      setLoading(false);
    }
  };

  const handleSearch = async (e) => {
    e.preventDefault();
    if (!searchQuery.trim()) return;

    try {
      setLoading(true);
      const response = await axios.post(`${API_BASE_URL}/search`, {
        query: searchQuery,
        limit: 5
      });
      setSearchResults(response.data.results);
    } catch (error) {
      console.error('Search error:', error);
      setSearchResults([]);
    } finally {
      setLoading(false);
    }
  };

  const handleChat = async (e) => {
    e.preventDefault();
    if (!chatMessage.trim()) return;

    const newMessage = { type: 'user', content: chatMessage };
    setChatHistory(prev => [...prev, newMessage]);
    
    try {
      setLoading(true);
      const response = await axios.post(`${LLM_API_URL}/chat`, {
        message: chatMessage,
        use_rag: true
      });
      
      const aiResponse = { 
        type: 'ai', 
        content: response.data.response,
        sources: response.data.sources 
      };
      setChatHistory(prev => [...prev, aiResponse]);
      
    } catch (error) {
      console.error('Chat error:', error);
      const errorResponse = { 
        type: 'ai', 
        content: '–í–∏–±–∞—á—Ç–µ, —Å—Ç–∞–ª–∞—Å—è –ø–æ–º–∏–ª–∫–∞ –ø—Ä–∏ –æ–±—Ä–æ–±—Ü—ñ –≤–∞—à–æ–≥–æ –∑–∞–ø–∏—Ç—É.' 
      };
      setChatHistory(prev => [...prev, errorResponse]);
    } finally {
      setLoading(false);
      setChatMessage('');
    }
  };

  return (
    <div className="App">
      <header className="App-header">
        <h1>üîç RAG System</h1>
        <p>–°–∏—Å—Ç–µ–º–∞ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º–∏ —Ç–∞ AI-–∞—Å–∏—Å—Ç–µ–Ω—Ç–æ–º</p>
      </header>

      <nav className="tabs">
        <button 
          className={activeTab === 'upload' ? 'active' : ''} 
          onClick={() => setActiveTab('upload')}
        >
          üìÅ –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è
        </button>
        <button 
          className={activeTab === 'search' ? 'active' : ''} 
          onClick={() => setActiveTab('search')}
        >
          üîç –ü–æ—à—É–∫
        </button>
        <button 
          className={activeTab === 'chat' ? 'active' : ''} 
          onClick={() => setActiveTab('chat')}
        >
          üí¨ –ß–∞—Ç –∑ AI
        </button>
      </nav>

      <main className="main-content">
        {stats && (
          <div className="stats-bar">
            <span>üìö –î–æ–∫—É–º–µ–Ω—Ç—ñ–≤: {stats.count || 0}</span>
            <span>üîß –ú–æ–¥–µ–ª—å: {stats.embedding_model}</span>
          </div>
        )}

        {activeTab === 'upload' && (
          <section className="upload-section">
            <h2>–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç—ñ–≤</h2>
            <div className="upload-area">
              <input
                type="file"
                multiple
                onChange={handleFileUpload}
                accept=".pdf,.txt,.md,.html,.csv,.xlsx,.docx,.json"
                disabled={loading}
              />
              <p>–ü—ñ–¥—Ç—Ä–∏–º—É–≤–∞–Ω—ñ —Ñ–æ—Ä–º–∞—Ç–∏: PDF, TXT, MD, HTML, CSV, XLSX, DOCX, JSON</p>
            </div>
            
            {uploadStatus && (
              <div className={`status ${uploadStatus.includes('–ü–æ–º–∏–ª–∫–∞') ? 'error' : 'success'}`}>
                {uploadStatus}
              </div>
            )}
          </section>
        )}

        {activeTab === 'search' && (
          <section className="search-section">
            <h2>–ü–æ—à—É–∫ –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö</h2>
            <form onSubmit={handleSearch} className="search-form">
              <input
                type="text"
                value={searchQuery}
                onChange={(e) => setSearchQuery(e.target.value)}
                placeholder="–í–≤–µ–¥—ñ—Ç—å –∑–∞–ø–∏—Ç –¥–ª—è –ø–æ—à—É–∫—É..."
                disabled={loading}
              />
              <button type="submit" disabled={loading}>
                {loading ? '‚è≥' : 'üîç'} –ó–Ω–∞–π—Ç–∏
              </button>
            </form>

            {searchResults.length > 0 && (
              <div className="search-results">
                <h3>–†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –ø–æ—à—É–∫—É:</h3>
                {searchResults.map((result, index) => (
                  <div key={index} className="result-item">
                    <div className="result-score">
                      –†–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ—Å—Ç—å: {(result.score * 100).toFixed(1)}%
                    </div>
                    <div className="result-source">
                      üìÑ {result.metadata.source}
                    </div>
                    <div className="result-text">
                      {result.text}
                    </div>
                  </div>
                ))}
              </div>
            )}
          </section>
        )}

        {activeTab === 'chat' && (
          <section className="chat-section">
            <h2>–ß–∞—Ç –∑ AI –∞—Å–∏—Å—Ç–µ–Ω—Ç–æ–º</h2>
            <div className="chat-container">
              <div className="chat-history">
                {chatHistory.map((msg, index) => (
                  <div key={index} className={`message ${msg.type}`}>
                    <div className="message-content">
                      {msg.content}
                    </div>
                    {msg.sources && msg.sources.length > 0 && (
                      <div className="message-sources">
                        <strong>–î–∂–µ—Ä–µ–ª–∞:</strong>
                        {msg.sources.map((source, idx) => (
                          <div key={idx} className="source">
                            üìÑ {source.source} (—Ä–µ–ª–µ–≤–∞–Ω—Ç–Ω—ñ—Å—Ç—å: {(source.score * 100).toFixed(1)}%)
                          </div>
                        ))}
                      </div>
                    )}
                  </div>
                ))}
              </div>
              
              <form onSubmit={handleChat} className="chat-form">
                <input
                  type="text"
                  value={chatMessage}
                  onChange={(e) => setChatMessage(e.target.value)}
                  placeholder="–ó–∞–¥–∞–π—Ç–µ –ø–∏—Ç–∞–Ω–Ω—è..."
                  disabled={loading}
                />
                <button type="submit" disabled={loading}>
                  {loading ? '‚è≥' : 'üì§'} –í—ñ–¥–ø—Ä–∞–≤–∏—Ç–∏
                </button>
              </form>
            </div>
          </section>
        )}
      </main>
    </div>
  );
}

export default App;